"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1475],{35769:function(e,t,n){n.d(t,{m:function(){return v}});var l=n(97458),s=n(52983),a=n(71485),i=n(68213),o=n(6394),r=n(36),c=n(88983),u=n(19494),d=n(71638),m=n(42495),h=n(63038),p=n(98111);let v=s.memo(e=>{let{showStopButton:t,onStopButtonClick:n,...v}=e,{currentOpenedModal:x}=(0,i.X)(),f=(0,a.useTranslations)("main.askInput"),k=(0,s.useCallback)(e=>{"Escape"===e.key&&t&&n&&null===x&&(e.preventDefault(),n())},[n,t,x]);return(0,s.useEffect)(()=>(document.addEventListener("keydown",k),()=>{document.removeEventListener("keydown",k)}),[k]),(0,l.jsx)(c.ZP,{className:"w-full",children:(0,l.jsx)(d.A,{transition:{duration:.2,bounce:.2,type:"spring"},children:(0,l.jsx)(m.E.div,{layout:!0,layoutRoot:!0,className:"flex items-center gap-x-xs",children:(0,l.jsx)(h.S,{children:(0,l.jsxs)(p.M,{mode:"popLayout",initial:!1,children:[t&&(0,l.jsx)(m.E.div,{initial:{scale:.2,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.2,opacity:0},children:(0,l.jsx)(u.Z,{toolTip:f("stopGenerating"),variant:"rejecter",pill:!0,icon:r.oD,keyboardShortcut:"Esc",onClick:n})},"stop-button"),(0,l.jsx)(m.E.div,{layout:!0,className:"grow",children:(0,l.jsx)(o.Z,{borderClass:"md:p-sm bg-offset dark:bg-offsetDark",hasShadow:!0,showFileUpload:!0,showCopilotToggle:!0,autofocus:null===x,querySource:v.submitWillFork?"fork":"followup",...v})},"ask-input")]})})})})})})},70178:function(e,t,n){n.d(t,{Z:function(){return h}});var l=n(97458),s=n(71485),a=n(52983),i=n(71570),o=n(29658),r=n(23298),c=n(19494),u=e=>{let{shareHref:t,hasMounted:n,isSharable:s}=e,{trackEvent:u}=(0,i.h)(),d=(0,a.useCallback)(()=>{navigator.clipboard.writeText(n?(0,r.RP)(decodeURIComponent(t)):""),u("click copy link button",{})},[t,n,u]);return s?(0,l.jsx)(c.Z,{clickFeedback:!0,size:"small",variant:"primary",onClick:d,toolTip:"Copy Link",tooltipLayout:"bottom",icon:o.nN}):null},d=n(32100),m=n(60936),h=e=>{let{isSharable:t,hasMounted:n,shareHref:a,EditorDropDownContent:i,icon:o,onClick:r}=e,{isMobileStyle:h}=(0,d.d)(),p=(0,s.useTranslations)("shared");return n?(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex items-center gap-x-sm",children:[(0,l.jsx)(u,{shareHref:a,hasMounted:n,isSharable:t}),(0,l.jsx)(m.p,{content:i,placement:"bottom-end",isMobileStyle:h,children:(0,l.jsx)(c.Z,{onClick:r,variant:"primary",size:"small",text:p("share"),icon:o})})]})}):null}},92625:function(e,t,n){var l=n(97458),s=n(35649),a=n(52983),i=n(71485),o=n(71570),r=n(57632),c=n(91007),u=n(75421),d=n(44835),m=n(29658),h=n(23298),p=n(6071),v=n(19494);t.Z=e=>{let{descriptionText:t,shareHref:n,isSharable:x,hasMounted:f,icon:k}=e,b=encodeURIComponent(t),{trackEvent:g}=(0,o.h)(),w=(0,i.useTranslations)("socialShare"),y=(0,i.useTranslations)("shared"),j=(0,a.useMemo)(()=>"https://twitter.com/intent/tweet?text=".concat(b,"&url=").concat(n),[b,n]),C=(0,a.useMemo)(()=>"https://api.whatsapp.com/send?text=".concat(b,"%20").concat(n),[b,n]),N=(0,a.useMemo)(()=>"https://www.facebook.com/sharer/sharer.php?u=".concat(n,"&quote=").concat(b),[b,n]),S=(0,a.useCallback)(()=>{navigator.clipboard.writeText(f?(0,h.RP)(decodeURIComponent(n)):""),g("click copy link button",{})},[n,f,g]),E=(0,a.useCallback)(()=>{var e;if(!(null===(e=navigator)||void 0===e?void 0:e.share)){window.open(j,"_blank");return}navigator.share({text:"".concat(t," ").concat(f?(0,h.RP)(decodeURIComponent(n)):""),title:"Perplexity AI"}),g("click mobile native share button",{})},[n,j,t,f,g]),Z=[{text:"Twitter",icon:u.NC,target:"_blank",href:j,onClick:()=>g("click tweet button",{})},{text:w("copyLink"),clickFeedback:!0,icon:m.nN,onClick:S},{text:"WhatsApp",icon:c.VH,target:"_blank",href:C,onClick:()=>g("click whatsapp button",{})},{text:"Facebook",icon:r.ne,target:"_blank",href:N,onClick:()=>g("click facebook button",{})}];return((0,a.useEffect)(()=>{f&&x&&S()},[f,x,S]),f&&x)?(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"mt-sm",children:(0,l.jsxs)(p.Z,{variant:"tiny",color:"super",children:[(0,l.jsx)(s.G,{icon:d.E9,className:"mr-xs"}),(0,l.jsx)("span",{children:w("linkCopied")})]})}),(0,l.jsxs)("div",{className:"hidden md:block",children:[(0,l.jsx)(p.Z,{variant:"baseSemi",className:"mb-sm mt-md",children:"Share"}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-xs",children:Z.map(e=>(0,l.jsx)("div",{children:(0,l.jsx)(v.Z,{layout:"left",size:"small",fullWidth:!0,...e})},e.text))})]}),(0,l.jsx)("div",{className:"block md:hidden",children:(0,l.jsx)("div",{className:"mt-md",children:(0,l.jsx)(v.Z,{variant:"primary",fullWidth:!0,text:y("share"),target:"_blank",icon:k,onClick:E})})})]}):null}},57818:function(e,t,n){var l=n(97458),s=n(82129),a=n(68493),i=n(52983),o=n(71485),r=n(32647),c=n(50882),u=n(32100),d=n(85393),m=n(19494),h=n(6071),p=n(88983),v=n(79738);t.Z=e=>{var t,n,x;let{showAvatar:f,showCreatorLabel:k,showEdit:b,isCurrentUser:g=!0,textColor:w,textVariant:y="smallBold",username:j,image:C,anon:N}=e,{data:S,update:E}=(0,a.useSession)(),[Z,T]=i.useState(!1),[_,R]=i.useState(null!=j?j:g?null==S?void 0:null===(t=S.user)||void 0===t?void 0:t.username:"Anonymous"),[P,A]=i.useState(),{isMobileUserAgent:L}=(0,u.d)(),M=(0,o.useTranslations)("settings.account"),U=async()=>fetch("/api/user",{method:"PUT",body:JSON.stringify({username:_})}),{mutate:z,isLoading:B}=(0,s.D)(U,{onSuccess:e=>{e.json().then(t=>{if(200!==e.status){A(t.message);return}T(!1),A(void 0),E()})}});(0,i.useEffect)(()=>{var e;R(null!=j?j:g?null==S?void 0:null===(e=S.user)||void 0===e?void 0:e.username:"Anonymous")},[j,g,null==S?void 0:null===(n=S.user)||void 0===n?void 0:n.username]);let F="@perplexity-bot@"===_;return(0,l.jsxs)("div",{className:"relative flex items-center gap-x-xs",children:[f&&(0,l.jsx)(r.Z,{size:"small",anon:N,user:F?"/static/images/bot.png":null!=C?C:g&&null!==(x=null==S?void 0:S.user.image)&&void 0!==x?x:void 0}),Z?(0,l.jsx)("div",{children:(0,l.jsx)(d.Z,{isMobileUserAgent:L,value:_,disabled:B,errorText:null!=P?P:""===_?"Username cannot be empty":"",onChange:e=>{R(e.target.value)},className:"md:min-w-[300px]",inlineEditBlock:S&&(0,l.jsxs)("div",{className:"ml-sm flex items-center gap-x-xs",children:[(0,l.jsx)(m.Z,{text:M("save"),variant:_===S.user.username||""===_||B?"common":"primary",size:"small",disabled:_===S.user.username||""===_||B,onClick:()=>z()}),(0,l.jsx)(m.Z,{text:M("cancel"),size:"small",disabled:B,onClick:()=>{R(S.user.username),T(!1)}})]})})}):(0,l.jsx)(h.Z,{variant:y,color:w,className:"break-all line-clamp-1",children:N?"Anonymous":F?"Perplexity Bot":_}),k&&(0,l.jsx)(p.ZP,{variant:"offset",className:"rounded-full px-sm py-xs",children:(0,l.jsx)(h.Z,{variant:"tiny",color:"light",children:"Author"})}),b&&!Z&&(0,l.jsx)(v.Z,{pill:!0,size:"small",icon:c.faPenToSquare,onClick:()=>T(!0)})]})}},45774:function(e,t,n){n.d(t,{O:function(){return a}});var l=n(52983),s=n(4544);function a(){let e=(0,s.nO)(),[t,n]=(0,l.useState)(!1);return(0,l.useCallback)((l,s,a,i)=>{e&&!t&&(n(!0),e.emit("update_thread_access",l,s,{read_write_token:a},e=>{n(!1),(null==e?void 0:e.access)!=null&&(null==i||i(null==e?void 0:e.access))}))},[t,e])}},53413:function(e,t,n){n.d(t,{$:function(){return o}});var l=n(52983),s=n(9205),a=n(77837),i=n.n(a);let o=e=>{let{items:t,inFlight:n,inFlightLatest:a,rwToken:o,headerOffset:r=52}=e,[c,u]=(0,l.useState)(!1),[d,m]=(0,l.useState)(!1),h=(0,s.f)(),p=(0,l.useRef)(!0),v=(0,l.useMemo)(()=>!o&&t.every(e=>"pending"!==e.status),[t,o]),[x,f]=(0,l.useState)({}),[k,b]=(0,l.useState)({}),g=(0,l.useCallback)(function(e){var t,n;let l=!(arguments.length>1)||void 0===arguments[1]||arguments[1],s="number"==typeof e?null===(t=x[e])||void 0===t?void 0:t.current:null===(n=k[e])||void 0===n?void 0:n.current;if(s){let e=s.getBoundingClientRect().top+window.scrollY-r;window.scrollTo({top:e,behavior:l?"smooth":"auto"})}},[x,k,r]),w=(0,l.useCallback)(()=>{g(t.length-1)},[g,t.length]);return(0,l.useEffect)(()=>{f(e=>{let n={...e},s={...k},a=!1;return t.forEach((e,t)=>{let i=e.backend_uuid;if(n[t])s[i]=n[t];else{let e=l.createRef();n[t]=e,s[i]=e,a=!0}}),Object.keys(n).forEach(e=>{t.some((t,n)=>n===Number(e))||(delete n[Number(e)],a=!0)}),a&&b(s),a?n:e})},[t.length,k]),(0,l.useEffect)(()=>{if(t.length<=1||!h)return;let e=window.location.hash;if(e&&!n&&p.current){try{let t=e.slice(1);t.length>3?g(t,!1):g(Number(t),!1)}catch(e){console.error(e)}return}a&&g(t.length-1)},[n,a,v,t.length,x,k,h,g]),(0,l.useEffect)(()=>{let e=i()(()=>{var e;let n=null===(e=x[t.length-1])||void 0===e?void 0:e.current;if(n){let e=n.getBoundingClientRect().top+window.scrollY-100,t=document.body.scrollHeight>window.innerHeight,l=window.innerHeight+window.scrollY>=document.body.scrollHeight-10;if(window.scrollY>=e||!t||l)c&&m(!0),u(!1);else{if(d)return;u(!0)}}},200);return e(),window.addEventListener("scroll",e),()=>{window.removeEventListener("scroll",e),e.cancel()}},[x,c,d,t.length,100]),{refs:x,scrollToLatestItem:w,scrollToListItem:g,showScrollButton:c&&!d,hasScrolled:d,setHasScrolled:m}}}}]);