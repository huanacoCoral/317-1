"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1075,3939],{93939:function(e,t,l){l.r(t),l.d(t,{default:function(){return N}});var n=l(97458),s=l(52983),i=l(90115),r=l.n(i),a=l(71485),o=l(12867),d=l(71570),c=l(32100),u=l(23298),h=l(9576),m=l(6071),x=l(41831),v=l(19494),p=l(51865),f=l.n(p);let g=e=>{var t;let{submit:l,editQueryValue:i,setEditQueryValue:r,setIsEditingQuery:p,isEditingQuery:g,isFirstResult:j}=e,y=(0,a.useTranslations)("shared"),{trackEvent:b}=(0,d.h)(),{isMobileStyle:w,isMobileUserAgent:C}=(0,c.d)(),{isFailed:k,result:N,isReadonly:_,isSnapshotRender:U}=(0,o.T)(),S=null==N?void 0:N.backend_uuid,E=null==N?void 0:N.frontend_context_uuid,I=null==N?void 0:N.query_str,R=(0,s.useCallback)(()=>{if(l){b("confirm edit query click",{newQuery:i});let e=(0,u.Mp)();l({rawQuery:i,existingEntryUUID:S,redoSearch:!0,collection:null,newFrontendContextUUID:_?e:null,existingFrontendContextUUID:_?null:E,promptSource:"user",querySource:"edit"})}},[l,b,i,S,E,_]),D=(0,s.useCallback)(()=>{r(null!=I?I:""),p(!1),b("cancel edit query click",{})},[r,I,p,b]),Z=(0,s.useCallback)(e=>{(0,h.Wk)(e)&&!C&&(e.preventDefault(),R())},[R,C]),T=""===i,F=(null!==(t=I.length)&&void 0!==t?t:0)>200;return(0,n.jsx)("div",{className:f()({"my-md md:my-lg":!U,"my-md":U}),children:g?(0,n.jsx)("div",{className:"flex w-full",children:(0,n.jsx)("div",{className:"grow",children:(0,n.jsx)(x.Z,{isMobileUserAgent:C,isMobileStyle:w,onKeyDown:Z,autoFocus:!0,size:"large",wrapperClassName:"grow",value:i,onChange:e=>r(e.target.value),inlineEditBlock:(0,n.jsxs)("div",{className:"flex items-center gap-x-xs pl-sm",children:[(0,n.jsx)(v.Z,{text:y("cancel"),size:"small",pill:!0,onClick:D}),(0,n.jsx)(v.Z,{text:y("save"),pill:!0,variant:T?"common":"primary",size:"small",disabled:T,onClick:R})]})})})}):(0,n.jsx)(m.Z,{variant:F?"baseSemi":"entry-title",as:j?"h1":"div",className:f()("whitespace-pre-line break-words [word-break:break-word] ",{"whitespace-pre-wrap":F}),children:k?(0,n.jsx)("div",{className:"flex items-center gap-x-sm",children:(0,n.jsx)("span",{children:null!=I?I:"Something went wrong..."})}):I})})};var j=l(161),y=l(67691),b=l(88983);let w=r()(()=>Promise.all([l.e(3848),l.e(3606),l.e(2862),l.e(6024),l.e(6953),l.e(1959),l.e(8938)]).then(l.bind(l,63703)).then(e=>e.ThreadContent),{loadableGenerated:{webpack:()=>[63703]},loading:()=>(0,n.jsx)(j.a,{})}),C=r()(()=>Promise.all([l.e(3848),l.e(6953),l.e(2653)]).then(l.bind(l,72653)),{loadableGenerated:{webpack:()=>[72653]}}),k=(0,s.forwardRef)((e,t)=>{var l;let{result:i,inFlight:r,showAnimations:a=!1,isLastResult:h=!1,isFirstResult:m=!1,isSnapshotRender:x,idx:v,submit:p,onRelatedButtonClick:j,showSurvey:k=!1,onBotStep:N,deleteLast:_,isReadonly:U}=e,{isMobileStyle:S}=(0,c.d)(),{trackEvent:E}=(0,d.h)(),[I,R]=(0,s.useState)(r),D=(0,s.useRef)(null),Z=(0,s.useRef)(r),[T,F]=(0,s.useState)(!1),[A,M]=(0,s.useState)(null!==(l=null==i?void 0:i.query_str)&&void 0!==l?l:""),P=(0,s.useMemo)(()=>i?(0,u.cW)(i):[],[i]),L=(null==i?void 0:i.status)==="failed",B=(null==i?void 0:i.status)==="pending",q=null!=P&&P.length>0,O=!q||P[P.length-1].step_type===y.WU.FINAL,G=(0,s.useMemo)(()=>i?(0,u.EH)(i):null,[i]),W=(0,s.useMemo)(()=>{var e;return L?[]:null!==(e=null==i?void 0:i.media_items)&&void 0!==e?e:[]},[null==i?void 0:i.media_items,L]),Q=(null==i?void 0:i.status)==="pending",z=!S&&O,H=(0,s.useMemo)(()=>W.filter(e=>"image"===e.medium||"map"===e.medium),[W]);if((0,s.useEffect)(()=>{R(Q)},[Q]),(0,s.useEffect)(()=>{let e=m&&h,t=Z.current&&!I;e&&t&&O&&(()=>{let e=setTimeout(()=>{E("engaged",{})},1e4);return()=>{clearTimeout(e)}})(),Z.current=I},[I,m,O,h,E]),!i)return(0,n.jsx)("div",{});let V=H.length>0;return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{ref:t}),(0,n.jsx)("div",{ref:D}),(0,n.jsx)(o.A,{idx:v,result:i,response:G,inFlight:I,isReadonly:U,isPending:B,hasSteps:q,isCopilot:q,mediaItems:W,filteredMediaItems:H,isFailed:L,isFinalStep:O,isSnapshotRender:x,isLastResult:h,children:(0,n.jsx)(b.ZP,{className:f()("pb-lg",{"border-b":!h&&!x,"min-h-[54vh]":I&&h&&!x}),children:(0,n.jsxs)("div",{className:x?V?"md:grid grid-cols-12 gap-md":"":"md:grid grid-cols-12 gap-xl",children:[(0,n.jsxs)("div",{className:"col-span-8",children:[(0,n.jsx)(g,{setEditQueryValue:M,isFirstResult:m,submit:p,setIsEditingQuery:F,isEditingQuery:T,editQueryValue:A}),(0,n.jsx)(w,{onRelatedButtonClick:j,showSurvey:k,onBotStep:N,deleteLast:_,localRef:D,showAnimations:a,submit:p,setIsEditingQuery:F,isEditingQuery:T,setEditQueryValue:M})]}),(0,n.jsx)("div",{className:"col-span-4",children:z&&(0,n.jsx)(C,{isStreaming:B,showAnimations:a})})]})})})]})});k.displayName="ThreadEntry";var N=k},12867:function(e,t,l){l.d(t,{A:function(){return a},T:function(){return o}});var n=l(97458),s=l(52983),i=l(23298);let r=(0,s.createContext)({result:null,steps:null,isPending:!1,mediaItems:[],response:null,isFailed:!1,isReadonly:!1,inFlight:!1,idx:null,isCopilot:!1,filteredMediaItems:[],isLastResult:!1,isFirstResult:!1,hasAnswer:!1,hasSteps:!1,isFinalStep:!1,isSnapshotRender:!1}),a=e=>{let{children:t,result:l,response:a,isReadonly:o,idx:d,inFlight:c,isPending:u,hasSteps:h,isFinalStep:m,isCopilot:x,mediaItems:v,filteredMediaItems:p,isFailed:f,isSnapshotRender:g,isLastResult:j}=e,y=(0,s.useMemo)(()=>l?(0,i.cW)(l):[],[l]),b=!!(null==a?void 0:a.answer);return(0,n.jsx)(r.Provider,{value:{isPending:u,hasSteps:h,isFinalStep:m,isCopilot:x,mediaItems:v,filteredMediaItems:p,isFailed:f,steps:y,result:l,response:a,isReadonly:o,inFlight:c,idx:d,hasAnswer:b,isSnapshotRender:g,isFirstResult:0===d,isLastResult:j},children:t})},o=()=>{let e=(0,s.useContext)(r);if(!e)throw Error("useThreadEntry must be used within ThreadEntryProvider");return e}},161:function(e,t,l){l.d(t,{a:function(){return i}});var n=l(97458),s=l(88983);let i=()=>(0,n.jsxs)("div",{className:"animate-pulse",children:[(0,n.jsxs)("div",{className:"flex gap-sm",children:[(0,n.jsx)(s.ZP,{variant:"offset",className:"h-[22px] w-[22px] rounded-full"}),(0,n.jsx)(s.ZP,{variant:"offset",className:"h-[22px] w-[80px] rounded-full"})]}),(0,n.jsx)(s.ZP,{variant:"offset",className:"mt-md h-[80px] rounded-md"})]})},51075:function(e,t,l){l.d(t,{j:function(){return eR}});var n=l(97458),s=l(52983),i=l(59842),r=l(90115),a=l.n(r),o=l(2763),d=l(68493),c=l(71485),u=l(62361),h=l(35769),m=l(6619),x=l(75630),v=l(4544),p=l(21831),f=l(37423),g=l(9205);function j(){let e=(0,u.useRouter)(),t=(0,g.f)()?window.location.origin:"https://www.perplexity.ai";return new URL("".concat(t).concat(e.asPath)).searchParams}var y=l(85002),b=l(32100),w=l(23298),C=l(88983),k=l(19494),N=l(51865),_=l.n(N),U=l(98111),S=l(42495),E=l(77837),I=l.n(E);let R=e=>{let{left:t,width:l,lastResult:i,showStopButton:r,scrollToLatestEntry:a,showScrollButton:o,hasScrolled:g,setHasScrolled:N,existingFrontendContextUUID:E,moreThanOneResult:R,lastEntryUUID:D,isReadonly:Z}=e,T=(0,c.useTranslations)("askInput"),F=(0,c.useTranslations)("shared"),A=j().get("q"),{submitQuery:M}=(0,p.e)(),P=(0,u.useRouter)(),L=(0,x.lG)(),B=(0,v.nO)(),{data:q}=(0,d.useSession)(),{inFlight:O}=(0,f.a0)(),{isMobileStyle:G}=(0,b.d)(),W=(0,s.useCallback)(e=>{let t=(0,w.Mp)();M({fork:Z,rawQuery:e.query,copilotOverride:!!L&&void 0,attachments:e.attachments,collection:null,newFrontendContextUUID:Z?t:null,existingFrontendContextUUID:Z?null:E,promptSource:"user",querySource:"followup"}),Z&&P.push("/search?q=pending&newFrontendContextUUID=".concat(t),"/search?",{shallow:!0})},[Z,M,L,E,P]),{setUserInput:Q,...z}=(0,m.l)({clearInputOnSubmit:!0,onSubmit:I()(W,1e3,{leading:!0})}),H=(0,s.useMemo)(()=>{try{if(!i)throw Error("lastResult is null");let e=(0,w.cW)(i);return null!=e&&"FINAL"!==e[e.length-1].step_type}catch(e){return!1}},[i]),V=(0,s.useCallback)(()=>{null==B||B.emit("perplexity_terminate",{entry_uuid:D})},[D,B]);return(0,s.useEffect)(()=>{""!=A&&Q("")},[A,Q]),t>0&&(0,n.jsx)(C.ZP,{style:{left:G?"0px":"".concat(t,"px"),width:G?"100%":"".concat(l,"px")},className:_()("pointer-events-none fixed z-10 grid-cols-12 gap-xl px-sm py-sm md:bottom-lg md:grid md:px-0",{"!hidden":H,"bottom-[64px]":q,"bottom-0":!q}),children:(0,n.jsxs)("div",{className:"pointer-events-auto md:col-span-8",children:[(0,n.jsx)(U.M,{initial:!1,children:o&&!g&&R&&(0,n.jsx)(S.E.div,{className:"mb-2 flex justify-center",initial:{opacity:0,y:5},animate:{opacity:1,y:0,transition:{delay:1,duration:.15,ease:"easeOut"}},exit:{opacity:0,transition:{duration:.1,ease:"easeOut"}},children:(0,n.jsx)("div",{className:"inline-flex rounded-full bg-offset shadow-md dark:bg-offsetDark",children:(0,n.jsx)(k.Z,{size:"small",variant:"common",icon:y.r5,layout:"center",pill:!0,onClick:()=>{a(),N(!0)},toolTip:F("scrollToBottom")})})})}),(0,n.jsx)(h.m,{...z,isFollowUp:!0,disabled:O,placeholder:G&&O?"":T("placeholderFollowUp"),submitWillFork:Z,showStopButton:r,onStopButtonClick:V})]})})};var D=l(83866),Z=l(88321),T=l(37852),F=l(53413),A=l(19893),M=l(10460),P=l(15296),L=l(57233),B=l(93939),q=l(35649),O=l(65531),G=l.n(O),W=l(75313),Q=l(99407),z=l(6071),H=e=>{let{currentCollection:t,size:l,handleCollectionChange:s,viewOnly:i}=e,r=(0,c.useTranslations)("shared");if(i&&!t)return null;let a=(0,n.jsxs)(z.Z,{variant:"small"===l?"tiny":"smallBold",color:"light",className:"flex cursor-pointer select-none items-center gap-x-xs px-sm py-xs transition duration-300 hover:opacity-70",children:[(0,n.jsx)("div",{children:(0,n.jsx)(q.G,{icon:Q.r8})}),(0,n.jsx)("div",{children:r("collection")})]});return(0,n.jsx)("div",{children:t?t?(0,n.jsx)(G(),{href:"/collections/".concat(t.slug),children:(0,n.jsxs)(z.Z,{variant:"small"===l?"tiny":"smallBold",className:"flex cursor-pointer select-none items-center gap-x-xs px-sm py-xs transition duration-300 hover:opacity-70",children:[(0,n.jsx)(W.B,{unified:t.emoji,size:"tiny"}),(0,n.jsx)("span",{className:"overflow-hidden truncate text-ellipsis",children:t.title})]})}):null:(0,n.jsx)("div",{onClick:i?void 0:s,children:a})})},V=l(10055),X=l(64088),J=l(80425),$=l(2540),K=l(93314),Y=l(22119),ee=l(7939),et=l(68213),el=l(21026),en=l(57818),es=l(58076),ei=l(51253),er=l(49544),ea=()=>{let{firstResult:e,socialStats:t}=(0,f.a0)();if(!(null==e?void 0:e.backend_uuid))return(0,n.jsx)(n.Fragment,{});let l=t&&t.viewCount>0,s=t&&t.forkCount>0;return l||s?(0,n.jsxs)(C.ZP,{className:"flex items-center gap-x-sm ",children:[l&&(0,n.jsxs)(z.Z,{variant:"tiny",color:"light",className:"flex items-center gap-x-xs",children:[(0,n.jsx)(q.G,{size:"sm",fixedWidth:!0,icon:er.Md}),(0,n.jsx)("div",{children:(0,w.uf)(t.viewCount)})]}),s&&(0,n.jsxs)(z.Z,{variant:"tiny",color:"light",className:"flex items-center gap-x-xs",children:[(0,n.jsx)(q.G,{size:"sm",fixedWidth:!0,icon:ei.MD}),(0,n.jsx)("div",{children:(0,w.uf)(t.forkCount)})]})]}):(0,n.jsx)(n.Fragment,{})},eo=l(51746),ed=l(21429);let ec=s.memo(e=>{let{assistant:t,authorUsername:l,threadAccess:s,authorImage:i}=e,{threadMetadata:r}=(0,f.a0)(),a=null===l||""===l,o=(0,c.useTranslations)("shared");return(0,n.jsxs)("div",{className:"flex items-center gap-x-md",children:[(0,n.jsx)(C.ZP,{className:" rounded-full",children:(0,n.jsx)(en.Z,{anon:a,image:null!=i?i:void 0,username:null!=l?l:void 0,showAvatar:!0,showCreatorLabel:!1,showEdit:!1,isCurrentUser:!1})}),null!=t&&"internet"!==t&&(0,n.jsx)(C.ZP,{className:"rounded-full",children:(0,n.jsx)(es.Z,{textVariant:"smallBold",assistant:t})}),!a&&(null!=s?s:0)>=eo.uv.PUBLIC_READ&&(0,n.jsx)(ea,{}),(0,n.jsx)(ed.Z,{timestamp:r.updated_datetime,isRecentHidden:!0,layoutType:"bottom",translations:{yearsAgo:o("yearsAgo"),monthsAgo:o("monthsAgo"),daysAgo:o("daysAgo"),hoursAgo:o("hoursAgo"),minutesAgo:o("minutesAgo")}})]})});var eu=l(78931),eh=l(92625),em=l(45774),ex=l(8394),ev=l(70178),ep=l(22326),ef=l(67691),eg=l(14765);let ej=s.memo(e=>{var t,l,s;let{descriptionText:i,sharableURL:r}=e,{openModal:a}=(0,et.X)(),o=(0,g.f)(),d=(0,x.lG)(),u=(0,eu.NL)(),{threadMetadata:h}=(0,f.a0)(),m=h.rwToken,v=h.frontendContextUUID,p=h.contextUUID,j=h.collection,y=null!==(s=null!==(l=null==j?void 0:j.access)&&void 0!==l?l:h.thread_access)&&void 0!==s?s:ef.k6,b=(0,em.O)(),w=(0,c.useTranslations)("search.thread"),C=e=>{e!==y&&(d?null!=p&&null!=m&&b(p,e,m,e=>{u.setQueryData(["results",{frontend_context_uuid:v}],t=>{if(!t)return;let[l,...n]=t;return[{...l,thread_access:e},...n]})}):a("loginModal",{pitchMessage:{title:w("shareLogin",{threads:"Threads"}),description:w("shareDescription",{threads:"Threads",collections:"Collections"})},origin:eo.FM.SHARE_DROPDOWN}))},k=(0,ep.o)({currentAccessLevel:y,onClick:C,isCollection:!1}),N=k[y],_=y>eo.uv.PRIVATE_READ,U=null!=j,S=(0,n.jsxs)("div",{className:"p-sm",children:[U?(0,n.jsxs)("div",{className:"",children:[(0,n.jsxs)(z.Z,{variant:"smallBold",className:"pb-sm",children:["View Access set to"," ",null===(t=k[null==j?void 0:j.access])||void 0===t?void 0:t.text," by:"]}),(0,n.jsx)(ex.n,{selected:!1,selectCollection:()=>null,collection:j})]}):null!=m?(0,n.jsxs)("div",{className:"",children:[(0,n.jsx)(z.Z,{variant:"baseSemi",className:"",children:"View Access"}),(0,n.jsx)(eg.Z,{choices:k})]}):null,(0,n.jsx)(eh.Z,{descriptionText:i,shareHref:r,isSharable:_,hasMounted:o,icon:null==N?void 0:N.icon})]});return(0,n.jsx)(ev.Z,{isSharable:_,hasMounted:o,shareHref:r,EditorDropDownContent:S,icon:null==N?void 0:N.icon,onClick:()=>C(eo.uv.PUBLIC_READ)})}),ey=s.memo(e=>{let{visible:t,tweetDescriptionText:l,threadSharedSlug:i}=e,r=(0,g.f)(),[a,o]=(0,s.useState)("");(0,s.useEffect)(()=>{let{protocol:e,host:t}=window.location;o("".concat(e,"//").concat(t,"/search/").concat(i))},[i]);let d=(0,s.useMemo)(()=>encodeURIComponent(r?(0,w.RP)(decodeURIComponent(a)):""),[a,r]),c=(0,s.useMemo)(()=>null!=l?"Perplexity AI: ".concat(l):"Perplexity AI",[l]),u=(0,s.useMemo)(()=>_()("transition-all duration-300 opacity flex items-center gap-x-xs md:gap-x-0",{"opacity-0":!t,"opacity-100":t}),[t]);return(0,n.jsx)("div",{className:u,children:t&&(0,n.jsx)(ej,{descriptionText:c,sharableURL:d})})});var eb=l(67592),ew=l(80937),eC=l(33542),ek=l(25621);let eN=s.memo(e=>{var t,l,i,r,a;let{entryUUID:o,frontendContextUUID:d,collection:h}=e,m=(0,u.useRouter)(),v=(0,g.f)(),p=(0,x.lG)(),{collections:j}=(0,K.l)(),y=(0,Z.p)(),{searchTerm:b}=(0,el.p)(),w=(0,$.J)(),{deleteThread:N}=(0,Y.l)(),{openModal:_,closeModal:U}=(0,et.X)(),{refetch:S,addItemToSidebar:E}=(0,ee.f)(),{removeThreadFromCollection:I}=(0,J.Fb)(),{isLoading:R,threadMetadata:D}=(0,f.a0)(),{trackEvent:F}=(0,T.WS)(),A=(0,c.useTranslations)("search.thread");(0,s.useEffect)(()=>{let e=D.title||D.first_query,t=D.thread_url_slug;y&&v&&e&&t&&(E({id:o,variant:"thread",title:e,permalink:"/search/".concat(t,"?newFrontendContextUUID=").concat(d)}),S())},[D,y,v,d,o,E,S]);let M=(0,s.useCallback)(()=>{F("click back button",{})},[F]),P=(0,s.useCallback)(()=>{F("click logo",{})},[F]),L=(0,s.useCallback)(()=>{o&&(F("delete thread from search result page click",{entryUUID:o}),N({entryUUID:o,callback:()=>m.push("/")}))},[N,o,m,F]),B=(0,s.useCallback)(()=>{if(p){if(0===j.length)w.listUserCollections(e=>{if(0===e.length)_("collectionCreateOrEdit",{frontendContextUUID:d,existingCollection:null,searchTerm:b});else{var t;_("collectionSelectModal",{entryUUID:o,userCollections:e,currentCollection:h,searchTerm:null!==(t=D.first_query)&&void 0!==t?t:"",frontendContextUUID:d})}});else{var e;_("collectionSelectModal",{entryUUID:o,userCollections:j,currentCollection:h,searchTerm:null!==(e=D.first_query)&&void 0!==e?e:"",frontendContextUUID:d})}}else _("loginModal",{pitchMessage:{title:A("headerLogin",{threads:"Threads"})},origin:eo.FM.COLLECTIONS})},[h,w,o,d,p,_,b,A,D.first_query,j]),O=!!y&&p||null!=h,W=!!y&&p||D.title!=eb.i&&null!=D.title,Q=O&&W;return(0,n.jsx)(C.ZP,{variant:"background",className:"sticky left-0 right-0 top-0 z-20 border-b md:mb-0 md:rounded-t-xl",children:(0,n.jsxs)("div",{className:"flex items-center justify-between gap-x-md px-md py-sm md:min-h-[53px]",children:[(0,n.jsx)("div",{className:"hidden md:block",children:!R&&(0,n.jsx)(ec,{assistant:null!==(t=D.assistant)&&void 0!==t?t:null,authorUsername:null!==(l=D.author_username)&&void 0!==l?l:null,threadAccess:null!==(i=D.thread_access)&&void 0!==i?i:0,authorImage:null!==(r=D.author_image)&&void 0!==r?r:null})}),(0,n.jsxs)("div",{className:"flex items-center gap-x-sm md:hidden",children:[(0,n.jsx)(G(),{href:"/",onClick:P,children:(0,n.jsx)(ek.Z,{size:"small",variant:"mark"})}),(0,n.jsx)(k.Z,{variant:"common",size:"small",text:"New",icon:ew.r8,href:"/",onClick:M})]}),(0,n.jsxs)("div",{className:"hidden max-w-md grow items-center justify-center gap-x-xs text-center md:flex",children:[O&&(0,n.jsx)(H,{currentCollection:h,handleCollectionChange:B,viewOnly:!p||!y}),Q&&(0,n.jsx)(z.Z,{variant:"smallBold",color:"light",children:(0,n.jsx)(q.G,{icon:eC.D2})}),W&&(0,n.jsx)(eb.Z,{title:D.title,contextUUID:D.contextUUID,rwToken:y,frontendContextUUID:d})]}),(0,n.jsxs)("div",{className:"flex items-center gap-x-sm",children:[(0,n.jsx)(V.Z,{show:v&&!!y,onDelete:L,onAddToCollection:B,onSwapCollection:B,onRemoveFromCollection:()=>{I({entryUUID:o,oldCollectionUUID:null==h?void 0:h.uuid,callback:U,frontendContextUUID:d})},currentCollection:h,rwToken:y,type:X.W.LIBRARY}),(0,n.jsx)(ey,{visible:!!D.thread_url_slug,tweetDescriptionText:D.title||D.first_query,threadSharedSlug:null!==(a=D.thread_url_slug)&&void 0!==a?a:void 0})]})]})})});var e_=e=>{let{parentInfo:t}=e,l="article"===t.mode?"article":"search";return(0,n.jsx)(G(),{href:"/".concat(l,"/").concat(t.thread_url_slug),children:(0,n.jsx)(C.ZP,{variant:"offset",bgHover:"offsetPlus",className:"flex justify-between rounded-lg p-md md:mt-md",children:(0,n.jsxs)("div",{className:"",children:[(0,n.jsxs)(z.Z,{color:"light",variant:"tiny",className:"mb-xs flex items-center gap-x-xs",children:[(0,n.jsx)(q.G,{icon:ei.MD}),(0,n.jsx)("div",{children:"Follow up to"})]}),(0,n.jsx)(z.Z,{variant:"section-title",color:"light",className:"break-all line-clamp-1",children:t.query_str})]})})})},eU=l(32397),eS=l(50361);let eE=a()({loader:()=>l.e(3082).then(l.bind(l,33082)),ssr:!1},{loadableGenerated:{webpack:()=>[33082]}}),eI=a()({loader:()=>l.e(1379).then(l.bind(l,91379)),ssr:!1},{loadableGenerated:{webpack:()=>[91379]}}),eR=()=>{var e,t,l,r;let a=(0,Z.p)(),d=(0,eU.X)(),[c,{left:h,width:m}]=(0,i.Z)(),{trackEvent:g}=(0,T.WS)(),{thread:y,inFlight:k,inFlightLatest:N,lastResult:_,threadMetadata:U}=(0,f.a0)(),S=null===(e=y[0])||void 0===e?void 0:e.frontend_context_uuid,{isMobileStyle:E}=(0,b.d)(),{submitQuery:I,handleBotStep:q,deleteLastResult:O}=(0,p.e)(),{setAssistant:G,assistant:W,setIsCopilot:Q,gpt4Limit:z}=(0,A.h)();(0,s.useEffect)(()=>{var e,t;G(null!==(t=null===(e=y[0])||void 0===e?void 0:e.search_focus)&&void 0!==t?t:"internet"),Q(y.some(e=>"copilot"===e.mode)&&!!z&&z>0)},[]),(0,s.useEffect)(()=>{var e;G(null!==(e=U.assistant)&&void 0!==e?e:W)},[U.assistant]);let H=(0,s.useMemo)(()=>!a&&(0,w.vl)(y),[y,a]),V=0===y.length||k,X=null==_?void 0:_.backend_uuid,J=(0,s.useCallback)(e=>{I(e)},[I]);!function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=j(),l=t.get("q"),n=t.get("copilot"),i=t.get("pro"),r=t.get("focus"),a=(0,x.lG)(),o=(0,v.nO)(),d=(0,u.useRouter)(),{setAssistant:c,setIsCopilot:h}=(0,A.h)(),{hasLoadedSettings:m,gpt4Limit:f}=(0,M.v)(),{submitQuery:g}=(0,p.e)();(0,s.useEffect)(()=>{if(a&&!m||!e||!l)return;let t=r&&r in P.w?r:void 0;void 0!==t&&c(t);let s=f>0&&("true"===n||"true"===i);h(s);let o=(0,w.Mp)();g({rawQuery:Array.isArray(l)?l[0]:l,assistantOverride:t,copilotOverride:s,collection:null,newFrontendContextUUID:o,existingFrontendContextUUID:null,promptSource:"user",querySource:"default_search"}),d.push("/search?q=pending&newFrontendContextUUID=".concat(o),"/search",{shallow:!0})},[m,o])}((0,s.useMemo)(()=>{var e;return 0===y.length||y.length>0&&(null===(e=y[0])||void 0===e||!e.backend_uuid)},[y]));let{refs:$,scrollToLatestItem:K,showScrollButton:Y,hasScrolled:ee,setHasScrolled:et,scrollToListItem:el}=(0,F.$)({items:y,inFlight:k,inFlightLatest:N,rwToken:a}),en=(0,s.useCallback)(e=>{el(e.existingEntryUUID,!0),I(e)},[el,I]),es=(0,s.useMemo)(()=>y&&(null==_?void 0:_.status)!=="completed"&&(null==_?void 0:_.backend_uuid)!==void 0&&k,[y,null==_?void 0:_.status,null==_?void 0:_.backend_uuid,k]);return(0,s.useEffect)(()=>{(null==y?void 0:y.length)>=1&&(null==_?void 0:_.status)==="completed"&&g("thread viewed",{authorId:U.author_id,authorUsername:U.author_username,isThreadCreator:!!a})},[g]),(0,n.jsxs)(o.L.Content,{mobileHeader:!1,childrenWidth:"large",header:(0,n.jsx)(eN,{collection:null!==(l=U.collection)&&void 0!==l?l:null,entryUUID:null!==(r=null===(t=y[0])||void 0===t?void 0:t.backend_uuid)&&void 0!==r?r:null,frontendContextUUID:S}),children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(L.u3,{firstResult:k?null:y[0]}),(0,n.jsx)("div",{className:"pb-[124px] pt-md md:pt-0",children:(0,n.jsxs)(C.ZP,{variant:"background",className:"relative",children:[U.parent_info&&(0,n.jsx)(e_,{parentInfo:U.parent_info}),(0,n.jsx)("div",{ref:c,children:y.map((e,t)=>{var l,i,r;let a=0===t,o=t===y.length-1;return(0,n.jsx)(s.Fragment,{children:(0,n.jsx)(D.Z,{fallback:(0,n.jsx)(eS.o,{description:null!==(l=null==e?void 0:e.text)&&void 0!==l?l:"Please try again later."}),children:(0,n.jsx)("div",{ref:$[t],children:(0,n.jsx)(B.default,{idx:t,result:e,inFlight:k,isReadonly:H,showAnimations:V&&o,submit:en,onRelatedButtonClick:J,isLastResult:o,isFirstResult:a,onBotStep:t=>q(e,t),showSurvey:!!d,deleteLast:o&&1!==y.length?()=>{var e;return O({frontendContextUUID:null===(e=y[0])||void 0===e?void 0:e.frontend_context_uuid})}:void 0})},null==e?void 0:e.backend_uuid)})},null!==(r=null!==(i=null==e?void 0:e.uuid)&&void 0!==i?i:null==e?void 0:e.backend_uuid)&&void 0!==r?r:t)})}),(0,n.jsx)(R,{left:h,width:m,lastResult:_,lastEntryUUID:X,showStopButton:es,scrollToLatestEntry:K,showScrollButton:Y,hasScrolled:ee,setHasScrolled:et,existingFrontendContextUUID:S,moreThanOneResult:y.length>1,isReadonly:H})]})})]}),(0,n.jsxs)("div",{className:"md:hidden",children:[(0,n.jsx)(eE,{havePrimaryButton:!1}),!k&&E&&(0,n.jsx)(eI,{})]})]})}},83866:function(e,t,l){var n=l(97458),s=l(52983);class i extends s.Component{static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.log({error:e,errorInfo:t})}render(){if(this.state.hasError){var e;return(null===(e=this.props)||void 0===e?void 0:e.fallback)?this.props.fallback:(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{children:"Oops, there is an error!"}),(0,n.jsx)("button",{type:"button",onClick:()=>this.setState({hasError:!1}),children:"Try again?"})]})}return this.props.children}constructor(e){super(e),this.state={hasError:!1}}}t.Z=i},88321:function(e,t,l){l.d(t,{p:function(){return r}});var n=l(37423),s=l(37911),i=l(9205);function r(){let e=(0,i.f)(),{thread:t}=(0,n.a0)();return e?(0,s.$)(t):void 0}},14765:function(e,t,l){var n=l(97458);l(52983);var s=l(88983),i=l(46610);t.Z=e=>{let{choices:t}=e;return(0,n.jsx)(s.ZP,{className:"rounded md:border divide-y mt-sm ",children:t.map((e,t)=>(0,n.jsx)(i.s,{rounded:!1,...e},t))})}},50361:function(e,t,l){l.d(t,{o:function(){return a}});var n=l(97458),s=l(52983);let i=e=>{try{return JSON.parse(e)}catch(e){return null}},r="Please try again later.",a=s.memo(e=>{let{title:t="Sorry, something went wrong.",description:l=r}=e,a=(0,s.useMemo)(()=>i(l),[l]);return a&&(l=r,console.warn("Tried to pass a JSON error description"),console.warn(a)),(0,n.jsxs)("div",{className:"bg-orange-100 border-l-4 border-orange-500 text-orange-700 p-4 text-left mt-4 rounded-lg",role:"alert",children:[(0,n.jsx)("p",{className:"font-bold",children:t}),(0,n.jsx)("p",{children:l})]})})},32397:function(e,t,l){l.d(t,{X:function(){return s}});var n=l(62361);function s(){let{"pplx-show-survey":e}=(0,n.useRouter)().query;return"edu"===e||"plus"===e||"default"===e||"copilot"===e?e:null}}}]);